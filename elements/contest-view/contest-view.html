<link rel="import" href="../../vendor/polymer/polymer.html">
<link rel="import" href="../../vendor/paper-toast/paper-toast.html">
<link rel="import" href="../fb-login/fb-login.html">
<link rel="import" href="../contest-data/contest-data.html">

<dom-module id="contest-view">
	<template>
		<style>
			:host {
				display: block;
				height: 100%;
			}
		    .container {
		        width: 80%;
		        margin: 50px auto;
		    }
		</style>
		<contest-data id="data" user="[[user]]"></contest-data>
		<paper-header-panel class="flex">
		    <paper-toolbar>
		    	<div></div>
		    	<div></div>
				<div>{{resp.name}}</div>
		    </paper-toolbar>
			<paper-toast id="message"
				text="You must be loged in to use this app"
				duration="5000">
			</paper-toast>
			<iron-pages selected="0">
				<div id="index">
					<div class="container">
						<fb-login
							id="loginbtn1"
							graph-url="me?fields=name"
							scope="public_profile, email, user_photos"
							response="{{resp}}"
							fire-user="{{user}}"
							on-fb-login-canceled="loginCancel">
						</fb-login>
						<!-- <fb-login
							id="loginbtn2"
							graph-url="me?fields=name"
							scope="public_profile, email, user_photos"
							response="{{resp}}"
							on-fb-login-canceled="loginCancel">
						</fb-login>
 -->						<paper-button raised on-tap="test">plop</paper-button>
					</div>
				</div>
				<div></div>
				<div></div>
			</iron-pages>
		</paper-header-panel>
	</template>
	<script>
		Polymer({
			is: 'contest-view',
			properties: {
				apiLoaded: {
					type: String,
					value: 'false',
					notify: true,
					observer: '_apiLoaded'
				},
				autoLogin: {
					type: Boolean,
					value: false
				},
				photos: {
					type: Array,
					notify: true
				}
			},
			// Property "apiLoaded" observer
			_apiLoaded: function (n, o) {
				if (n === 'true') {
					this.$.loginbtn1.apiLoaded = true;
					// this.$.loginbtn2.apiLoaded = true;
				}
				// if (n === 'true' && this.autoLogin) {
				// 	this.$.loginbtn1.apiLoaded = true;
				// } else if(n === 'true') {
				// 	this.$.loginbtn1.checkLoginStatus();
				// }
			},
			loginCancel: function () {
				this.$.message.open();
			},
			test: function () {
				this.photos = this.$.data.photos;
				this.push('photos', {name: 'plop'});
			}
		});
	</script>
</dom-module>
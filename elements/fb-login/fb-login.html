<link rel="import" href="../../vendor/polymer/polymer.html">
<link rel="import" href="../../vendor/paper-button/paper-button.html">
<link rel="import" href="../../vendor/iron-icon/iron-icon.html">

<dom-module id="fb-login">
	<template>
		<style>
			:host {
				display: inline-block;
			}

			paper-button {
				background-color: #3B579D;
			}

			.icon {
			    --iron-icon-height: 32px;
			    --iron-icon-width: 32px;
			}
		</style>
		<paper-button raised
			on-tap="_customLoginAction">
			<iron-icon class="icon" src="../../img/FB-f-Logo__blue_50.png"></iron-icon>
			Login</paper-button>
	</template>
	<script>
		Polymer({
			is: 'fb-login',
			properties: {
				config: {
					type: Object,
					notify: true
				},
				response: {
					type: Object,
					notify: true
				}
			},
			handleResponse: function (e) {
				this.config = e.detail.response;
				console.log(this.config);
			},
			_customLoginAction: function (response) {
				var fbLogin = this;
				if (response.status == 'connected') {
					FB.api('/me?fields=email', function(data) {
						fbLogin.response = data;
					});
				} else {
					console.log("variable");
				}
			},
			checkLoginStatus: function () {
				var fbLogin = this;
				FB.getLoginStatus(function(response) {
				 		// Check login status on load, and if the user is
				 		// already logged in, go directly to the welcome message.
				 		console.log(fbLogin);
				 		if (response.status == 'connected') {
				 			fbLogin._customLoginAction(response);
				 		} else {
				   		// Otherwise, show Login dialog first.
				   		FB.login(function(response) {
				   			fbLogin._customLoginAction(response);
				   		}, {scope: 'user_friends, email'});
					}
				});
			},
			ready: function () {
			}
		});
	</script>
</dom-module>
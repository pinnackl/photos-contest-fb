<dom-module id="participant-profile">
  <style type="text/css">
    :host {
      padding:1em;
    }

    .profile-picture{
      border-radius: 100%;
      cursor: pointer;
    }

    .participant{
      display: inline-block;
      margin-right: 50px;
    }

    section.contest-view{
      display: block;
    }
  </style>
    <template>
      <iron-localstorage id="ls" name="[[storageLabel]]" value="{{storage}}" auto-save-disabled></iron-localstorage>
      <firebase-collection
                location="{{participantLocation}}"
                data="{{participants}}"></firebase-collection>
      <template is="dom-repeat" items="[[participants]]" as="participant">
        <div class="participant">
          <img class="profile-picture" src="[[participant.photoUrl]]" alt="Avatar" data-route="[[participant.id]]" on-tap="_openProfile">
          <p class="fullName">[[participant.name]]</p>
        </div>
      </template>
    </template>
    <script type="text/javascript">
  Polymer({
    is: "participant-profile",

    behaviors: [
     Polymer.NeonAnimationRunnerBehavior,
     Polymer.NeonSharedElementAnimatableBehavior
    ],

    properties: {
      // START ANIMATIONS
      animationConfig: {
        value: function(){
          return {
            'entry': [{
              name: 'fade-in-animation',
              node: this
            },{
              name: 'transform-animation',
              transformFrom: 'translateX(-100vh)',
              node: this
            }],
            'exit': [{
              name: 'hero-animation',
              id: 'hero',
              fromPage: this
            },{
              name: 'fade-out-animation',
              node: this
            }],
          }
        }
      },
      // END ANIMATIONS
      participants: {},
      storageLabel: String,
      storage: {
        observer: "_storageChanged"
      }
    },
      _openProfile: function(event){
        if(event.target.classList.contains('participant-profile')){
          this.fire("updateShowcase",event.model.__data__["participant.id"]);
          this.sharedElements = {
            'hero': event.target
          }

          this.fire("changePage","participantShowcase");
        }  
      },
      _storageChanged: function(storage){
        if (storage) {
          this.participantLocation = [storage.firebase, 'participants'].join('/');
        }
      }

    // _repeatRender: function(){
    //   this.paperCard = Polymer.dom(this.root).querySelectorAll("paper-card");
    //   this.animationConfig["entry"].push({
    //     name: "cascaded-animation",
    //     animation: "transform-animation",
    //     transformFrom: "translateY(100vh)",
    //     nodes: this.paperCard
    //   })
    // },
  })
</script>
</dom-module>

